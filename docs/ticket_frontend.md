# 전시회 티켓 예약 시스템 - 프론트엔드 구조 및 개요

> **프로젝트명**: ticket-system  
> **목표**: 권한 기반 다중 관리자 지원 Next.js 프론트엔드  
> **작성일**: 2025.07.25  
> **버전**: v2.0 (권한 기반 UI 시스템)

## 📋 목차

1. [프론트엔드 아키텍처 개요](#-프론트엔드-아키텍처-개요)
2. [프로젝트 구조](#-프로젝트-구조)
3. [권한 기반 라우팅 시스템](#-권한-기반-라우팅-시스템)
4. [페이지별 구조 설계](#-페이지별-구조-설계)
5. [컴포넌트 아키텍처](#-컴포넌트-아키텍처)
6. [상태 관리 전략](#-상태-관리-전략)
7. [스타일링 시스템](#-스타일링-시스템)
8. [PWA 기능 구현](#-pwa-기능-구현)
9. [성능 최적화 전략](#-성능-최적화-전략)
10. [개발 환경 설정](#-개발-환경-설정)

---

## 🏗 프론트엔드 아키텍처 개요

### 🎯 설계 원칙

**1. 권한 기반 UI 시스템**
- 사용자 역할별 UI 컴포넌트 분리
- 권한 레벨에 따른 기능 접근 제어
- 이벤트별 데이터 격리 및 접근 제어

**2. 다중 인터페이스 지원**
- **고객 예약 인터페이스**: 이벤트별 독립 페이지 (/AAA, /BBB, /CCC)
- **슈퍼 관리자 대시보드**: 전체 시스템 관리 (/super-admin)
- **이벤트 관리자 대시보드**: 이벤트별 관리 (/admin)
- **PWA 입장 관리 앱**: 현장 스태프용 QR 스캐너 (/scanner)

**3. 성능 최적화**
- Next.js 14 App Router 활용
- Server Components와 Client Components 최적 분리
- 이미지 최적화 및 코드 스플리팅
- PWA 오프라인 지원

### 🔧 기술 스택 선택 이유

**React 18 + Next.js 14**
- **App Router**: 파일 시스템 기반 라우팅으로 권한별 경로 관리 용이
- **Server Components**: 초기 로딩 성능 최적화
- **Middleware**: 권한 검증 및 리다이렉션 처리
- **API Routes**: 백엔드 프록시 및 파일 업로드 처리

**JavaScript (ES6+) 우선 채택**
- 빠른 프로토타이핑 및 개발 속도
- 팀 러닝 커브 최소화
- 향후 TypeScript 마이그레이션 준비

**SCSS + CSS Modules**
- Tailwind CSS 대신 커스텀 디자인 시스템 구축
- 컴포넌트별 스타일 격리
- 다크 모드 및 테마 시스템 지원

---

## 📁 프로젝트 구조

### 디렉토리 아키텍처

```
frontend/
├── src/
│   ├── app/                           # Next.js 14 App Router
│   │   ├── layout.js                  # 루트 레이아웃
│   │   ├── page.js                    # 메인 랜딩 페이지
│   │   ├── middleware.js              # 권한 검증 미들웨어
│   │   │
│   │   ├── [event_code]/              # 동적 라우트 (AAA, BBB, CCC)
│   │   │   ├── layout.js              # 이벤트 공통 레이아웃
│   │   │   ├── page.js                # 이벤트 홈페이지
│   │   │   ├── booking/               # 예약 플로우
│   │   │   │   ├── page.js            # 티켓 선택
│   │   │   │   ├── checkout/          # 결제 페이지
│   │   │   │   └── success/           # 결제 완료
│   │   │   ├── notices/               # 공지사항
│   │   │   └── order/                 # 주문 조회
│   │   │
│   │   ├── super-admin/               # 슈퍼 관리자 (Level 9)
│   │   │   ├── layout.js              # 슈퍼 관리자 전용 레이아웃
│   │   │   ├── page.js                # 전체 시스템 대시보드
│   │   │   ├── login/                 # 슈퍼 관리자 로그인
│   │   │   ├── events/                # 이벤트 관리
│   │   │   ├── managers/              # 관리자 계정 관리
│   │   │   ├── analytics/             # 전체 통계 및 분석
│   │   │   └── settings/              # 시스템 설정
│   │   │
│   │   ├── admin/                     # 이벤트 관리자 (Level 1-3)
│   │   │   ├── layout.js              # 이벤트 관리자 레이아웃
│   │   │   ├── page.js                # 이벤트 대시보드
│   │   │   ├── login/                 # 이벤트 관리자 로그인
│   │   │   ├── products/              # 상품 관리
│   │   │   ├── orders/                # 주문 관리
│   │   │   ├── entrance/              # 입장 관리
│   │   │   ├── notices/               # 공지사항 관리
│   │   │   └── analytics/             # 이벤트 통계
│   │   │
│   │   └── scanner/                   # PWA 스캐너 앱
│   │       ├── layout.js              # PWA 전용 레이아웃
│   │       ├── page.js                # QR 스캔 메인 화면
│   │       ├── login/                 # 스태프 로그인
│   │       ├── settings/              # 스캐너 설정
│   │       └── history/               # 스캔 이력
│   │
│   ├── components/                    # 재사용 컴포넌트
│   │   ├── auth/                      # 인증 관련 컴포넌트
│   │   ├── layout/                    # 레이아웃 컴포넌트
│   │   ├── ui/                        # 기본 UI 컴포넌트
│   │   ├── dashboard/                 # 대시보드 컴포넌트
│   │   ├── booking/                   # 예약 관련 컴포넌트
│   │   ├── scanner/                   # PWA 스캐너 컴포넌트
│   │   └── forms/                     # 폼 관련 컴포넌트
│   │
│   ├── hooks/                         # 커스텀 훅
│   │   ├── useAuth.js                 # 인증 상태 관리
│   │   ├── usePermissions.js          # 권한 확인
│   │   ├── useCamera.js               # 카메라 API
│   │   ├── useQRScanner.js            # QR 스캔 기능
│   │   └── useOffline.js              # 오프라인 상태 관리
│   │
│   ├── stores/                        # 상태 관리 (Zustand)
│   │   ├── authStore.js               # 인증 상태
│   │   ├── bookingStore.js            # 예약 상태
│   │   ├── uiStore.js                 # UI 상태
│   │   └── scannerStore.js            # 스캐너 상태
│   │
│   ├── services/                      # API 서비스
│   │   ├── api.js                     # API 클라이언트
│   │   ├── auth.js                    # 인증 서비스
│   │   ├── booking.js                 # 예약 서비스
│   │   └── offline.js                 # 오프라인 서비스
│   │
│   ├── utils/                         # 유틸리티 함수
│   │   ├── permissions.js             # 권한 유틸
│   │   ├── formatters.js              # 데이터 포맷팅
│   │   └── validators.js              # 입력 검증
│   │
│   └── styles/                        # SCSS 스타일
│       ├── globals.scss               # 전역 스타일
│       ├── variables.scss             # SCSS 변수
│       ├── mixins.scss                # SCSS 믹스인
│       ├── themes/                    # 테마 시스템
│       ├── layouts/                   # 레이아웃별 스타일
│       ├── components/                # 컴포넌트별 스타일
│       └── pages/                     # 페이지별 스타일
│
├── public/                            # 정적 파일
│   ├── icons/                         # PWA 아이콘
│   ├── images/                        # 이미지 에셋
│   ├── manifest.json                  # PWA 매니페스트
│   └── sw.js                          # 서비스 워커
│
├── next.config.js                     # Next.js 설정
├── package.json                       # 의존성 관리
└── README.md                          # 프로젝트 문서
```

---

## 🔐 권한 기반 라우팅 시스템

### 라우팅 구조 및 권한 매핑

**1. 공개 접근 (인증 불필요)**
```
/ (메인 랜딩 페이지)
/[event_code] (이벤트 홈페이지)
/[event_code]/booking (티켓 예약)
/[event_code]/notices (공지사항)
/[event_code]/order/[order_number] (주문 조회)
```

**2. 슈퍼 관리자 전용 (admin_type: "super_admin")**
```
/super-admin/login (로그인)
/super-admin (전체 대시보드)
/super-admin/events (이벤트 관리)
/super-admin/managers (관리자 관리)
/super-admin/analytics (전체 통계)
/super-admin/settings (시스템 설정)
```

**3. 이벤트 관리자 (admin_type: "event_manager", Level 1-3)**
```
/admin/login (로그인)
/admin (이벤트 대시보드)
/admin/products (상품 관리 - Level 2+)
/admin/orders (주문 관리 - Level 1+)
/admin/entrance (입장 관리 - Level 1+)
/admin/notices (공지사항 관리 - Level 2+)
/admin/analytics (이벤트 통계 - Level 2+)
```

**4. PWA 스캐너 (현장 스태프)**
```
/scanner/login (스태프 로그인)
/scanner (QR 스캔 메인)
/scanner/settings (스캐너 설정)
/scanner/history (스캔 이력)
```

### 권한 레벨 정의

| 레벨 | 역할 | 권한 범위 |
|------|------|-----------|
| **Level 9** | 슈퍼 관리자 | 전체 시스템 관리, 모든 이벤트 접근 |
| **Level 3** | 이벤트 담당자 | 자신의 이벤트 전체 관리 (삭제 포함) |
| **Level 2** | 일반 관리자 | 자신의 이벤트 편집 (삭제 제외) |
| **Level 1** | 조회 전용 | 자신의 이벤트 조회 및 입장 관리 |

### 미들웨어 기반 권한 검증

**Next.js Middleware**
- JWT 토큰 검증 및 권한 확인
- 경로별 접근 권한 자동 검증
- 인증되지 않은 사용자 자동 리다이렉션
- 이벤트별 데이터 접근 권한 확인

---

## 📄 페이지별 구조 설계

### 1. 고객 예약 페이지 (/[event_code])

**이벤트 홈페이지**
- 이벤트 정보 및 이미지 갤러리
- 티켓 종류 및 가격 안내
- 최신 공지사항 (최대 5개)
- 예약하기 버튼 (메인 CTA)

**예약 플로우**
- **Step 1**: 티켓 선택 (상품, 옵션, 수량, 날짜)
- **Step 2**: 고객 정보 입력 (이름, 전화번호, 이메일)
- **Step 3**: 결제 방법 선택 (토스페이먼츠)
- **Step 4**: 예약 확인 및 결제

**결제 완료 페이지**
- QR 티켓 표시 (개별 QR 코드)
- 주문 상세 정보
- 스마트폰 저장 기능
- 공유 기능

### 2. 슈퍼 관리자 대시보드 (/super-admin)

**메인 대시보드**
- 전체 시스템 통계 (이벤트 수, 총 매출, 총 주문, 활성 관리자)
- 이벤트별 매출 차트
- 최근 활동 로그
- 빠른 액션 버튼

**이벤트 관리**
- 이벤트 목록 (테이블 형태)
- 이벤트 생성/수정/삭제
- 이벤트 활성화/비활성화
- 이벤트별 상세 통계

**관리자 관리**
- 관리자 목록 (이벤트별 필터)
- 관리자 계정 생성/수정/삭제
- 권한 레벨 관리
- 비밀번호 초기화

**전체 통계 및 분석**
- 매출 분석 (기간별, 이벤트별)
- 관리자 활동 로그
- 시스템 성능 지표
- 데이터 내보내기

### 3. 이벤트 관리자 대시보드 (/admin)

**이벤트 대시보드**
- 자신의 이벤트 통계 (매출, 주문, 입장, 재고)
- 오늘의 현황 (실시간 업데이트)
- 매출 추이 차트
- 최근 주문 목록
- 재고 부족 알림

**상품 관리 (Level 2+)**
- 상품 목록 및 재고 현황
- 상품 등록/수정/삭제
- 상품 옵션 관리 (성인/청소년/어린이)
- 재고 조정 기능

**주문 관리 (Level 1+)**
- 주문 목록 (필터링, 검색)
- 주문 상세 정보
- 환불 처리 (Level 3+)
- 주문 상태 변경
- 엑셀 내보내기

**입장 관리**
- QR 스캔 인터페이스 (웹 기반)
- 입장 로그 조회
- 입장 통계 (일별, 시간별)
- 수동 입장 처리

### 4. PWA 입장 관리 앱 (/scanner)

**QR 스캔 메인 화면**
- 카메라 뷰 및 QR 스캔 기능
- 실시간 스캔 결과 표시
- 입장 확인/거부 처리
- 오늘의 입장 통계

**오프라인 지원**
- 오프라인 스캔 데이터 저장
- 온라인 복구 시 자동 동기화
- 오프라인 상태 표시
- 대기열 관리

**설정 및 이력**
- 카메라 설정 (해상도, 포커스)
- 스캔 이력 조회
- 장치 정보 및 상태
- 로그아웃 기능

---

## 🧩 컴포넌트 아키텍처

### 컴포넌트 분류 체계

**1. Layout 컴포넌트**
- `RootLayout`: 전역 레이아웃 (SEO, 폰트, 전역 상태)
- `PublicLayout`: 고객용 레이아웃 (이벤트별 헤더/푸터)
- `SuperAdminLayout`: 슈퍼 관리자 레이아웃 (사이드바, 헤더)
- `AdminLayout`: 이벤트 관리자 레이아웃 (권한별 메뉴)
- `PWALayout`: PWA 스캐너 레이아웃 (모바일 최적화)

**2. Auth 컴포넌트**
- `PermissionGuard`: 권한 기반 렌더링 제어
- `ProtectedRoute`: 인증 필요 페이지 보호
- `RoleBasedComponent`: 역할별 UI 컴포넌트
- `LoginForm`: 관리자 타입별 로그인 폼

**3. UI 컴포넌트**
- `Button`: 다양한 변형 및 상태 지원
- `Input`: 폼 입력 필드 (검증 포함)
- `Modal`: 모달 다이얼로그
- `Toast`: 알림 메시지
- `Table`: 데이터 테이블 (정렬, 페이징)
- `Chart`: 차트 컴포넌트 (Chart.js 기반)

**4. Business 컴포넌트**
- `TicketSelector`: 티켓 선택 인터페이스
- `ProductManager`: 상품 관리 인터페이스
- `OrderTable`: 주문 목록 테이블
- `QRScanner`: PWA QR 스캔 기능
- `Dashboard`: 대시보드 위젯

### 컴포넌트 설계 원칙

**재사용성**
- 비즈니스 로직과 UI 로직 분리
- Props 기반 설정 가능한 유연한 인터페이스
- 컴포지션 패턴 활용

**접근성**
- ARIA 속성 및 키보드 네비게이션 지원
- 스크린 리더 호환성
- 포커스 관리 및 트랩

**반응형 디자인**
- 모바일 우선 설계
- 브레이크포인트별 최적화
- PWA 네이티브 앱 경험

---

## 🔄 상태 관리 전략

### 상태 관리 아키텍처

**1. 서버 상태 (React Query)**
- API 데이터 캐싱 및 동기화
- 백그라운드 업데이트
- 오류 재시도 및 복구
- 낙관적 업데이트

**2. 클라이언트 상태 (Zustand)**
- 인증 상태 (사용자 정보, 토큰)
- 예약 플로우 상태 (장바구니, 고객정보)
- UI 상태 (모달, 토스트, 로딩)
- 스캐너 상태 (오프라인 큐, 설정)

**3. 로컬 상태 (React useState)**
- 컴포넌트 내부 상태
- 폼 입력 상태
- 임시 UI 상태

### 상태 지속성 전략

**인증 상태**
- localStorage: 토큰 및 사용자 정보
- 자동 토큰 갱신 및 만료 처리
- 로그아웃 시 상태 정리

**예약 상태**
- sessionStorage: 예약 진행 중 데이터
- 페이지 새로고침 시 상태 복원
- 결제 완료 후 상태 정리

**오프라인 상태**
- IndexedDB: PWA 오프라인 데이터
- 서비스 워커 연동
- 온라인 복구 시 동기화

---

## 🎨 스타일링 시스템

### CSS 아키텍처

**1. SCSS + CSS Modules**
- 컴포넌트별 스타일 격리
- 전역 변수 및 믹스인 활용
- BEM 방법론 기반 클래스 네이밍

**2. 디자인 토큰 시스템**
- 색상, 타이포그래피, 간격 체계화
- CSS 커스텀 프로퍼티 활용
- 다크모드 및 테마 지원

**3. 반응형 디자인**
- 모바일 우선 (Mobile First) 접근
- 브레이크포인트 기반 미디어 쿼리
- 유연한 그리드 및 레이아웃 시스템

### 테마 시스템

**라이트 테마 (기본)**
- 고객 예약 페이지 및 관리자 대시보드
- 밝고 깔끔한 UI
- 높은 가독성 및 접근성

**다크 테마**
- 사용자 선택 옵션
- 야간 사용 시 눈의 피로 감소
- 모든 컴포넌트 다크모드 지원

**스캐너 테마**
- PWA 스캐너 전용 테마
- 어두운 배경으로 카메라 화면 최적화
- 높은 대비로 QR 인식률 향상

---

## 📱 PWA 기능 구현

### PWA 핵심 기능

**1. 서비스 워커**
- 오프라인 캐싱 전략
- 백그라운드 동기화
- 푸시 알림 지원

**2. 카메라 API**
- QR 코드 실시간 스캔
- 후면 카메라 우선 사용
- 카메라 권한 관리

**3. 네이티브 기능**
- 홈 화면 추가
- 전체 화면 모드
- 네이티브 앱과 유사한 UX

### 오프라인 전략

**캐시 우선 (Cache First)**
- 정적 에셋 (CSS, JS, 이미지)
- PWA 매니페스트 및 아이콘

**네트워크 우선 (Network First)**
- API 데이터
- 실시간 정보

**오프라인 폴백**
- 네트워크 오류 시 캐시된 데이터 사용
- 오프라인 안내 페이지
- 재연결 시 자동 동기화

---

## ⚡ 성능 최적화 전략

### Next.js 최적화

**1. 코드 스플리팅**
- 라우트별 자동 분할
- 동적 import 활용
- 컴포넌트별 지연 로딩

**2. 이미지 최적화**
- Next.js Image 컴포넌트
- WebP/AVIF 형식 변환
- 반응형 이미지 제공

**3. 서버 컴포넌트**
- 초기 HTML 생성 최적화
- 클라이언트 JavaScript 감소
- SEO 개선

### 런타임 최적화

**1. React 최적화**
- useMemo, useCallback 활용
- React.memo로 불필요한 리렌더링 방지
- 가상화된 리스트 (긴 목록 처리)

**2. 상태 관리 최적화**
- 필요한 컴포넌트만 구독
- 상태 정규화
- 지역 상태 우선 사용

**3. 네트워크 최적화**
- API 응답 캐싱
- 요청 디바운싱
- 병렬 요청 처리

---

## 🔧 개발 환경 설정

### 필수 의존성

**React 생태계**
```json
{
  "react": "^18.0.0",
  "react-dom": "^18.0.0",
  "next": "^14.0.0"
}
```

**상태 관리**
```json
{
  "@tanstack/react-query": "^5.0.0",
  "zustand": "^4.0.0"
}
```

**스타일링**
```json
{
  "sass": "^1.0.0",
  "classnames": "^2.0.0"
}
```

**PWA 및 유틸리티**
```json
{
  "next-pwa": "^5.0.0",
  "axios": "^1.0.0",
  "qr-scanner": "^1.0.0"
}
```

### 개발 도구 설정

**ESLint + Prettier**
- 코드 품질 및 일관성 유지
- Next.js 규칙 및 React Hooks 규칙
- 자동 포맷팅

**환경 변수 관리**
```bash
# .env.local
NEXT_PUBLIC_API_URL=http://localhost:8000
NEXT_PUBLIC_TOSS_CLIENT_KEY=test_ck_...
NEXT_PUBLIC_APP_ENV=development
```

**빌드 최적화**
```javascript
// next.config.js
module.exports = {
  experimental: {
    appDir: true,
  },
  images: {
    domains: ['localhost', 'ticket-system.com'],
  },
  compiler: {
    removeConsole: process.env.NODE_ENV === 'production',
  },
}
```

### 배포 전략

**개발 환경**
- `npm run dev`: 로컬 개발 서버
- Hot Module Replacement
- 소스맵 및 개발자 도구

**스테이징 환경**
- `npm run build`: 프로덕션 빌드
- 성능 및 번들 크기 분석
- E2E 테스트 실행

**프로덕션 환경**
- 정적 파일 CDN 배포
- 이미지 최적화 서비스
- 성능 모니터링

---

## 🎯 다음 단계

이 프론트엔드 구조 설계를 바탕으로 다음 작업들을 진행할 예정입니다:

### 📋 Step 1: 환경 설정
**[성능 최적화 및 보안](ticket_performance.md)** 문서로 고성능 시스템 구현 방법을 학습하세요.

### 🔧 Step 2: 개발 시작  
각 컴포넌트와 페이지를 단계별로 구현하며, 권한 기반 시스템을 점진적으로 구축합니다.

### ⚡ Step 3: 최적화
성능 측정 및 최적화를 통해 1만명 동시 접속 목표를 달성합니다.

### 🚀 Step 4: 배포
PWA 기능을 포함한 완전한 시스템을 프로덕션 환경에 배포합니다.

---

## 💡 핵심 특징 요약

이 프론트엔드 시스템의 핵심 특징은 다음과 같습니다:

### 🔐 **권한 기반 다중 인터페이스**
- 슈퍼 관리자, 이벤트 관리자, 고객, 현장 스태프별 최적화된 UI
- JWT 기반 권한 검증 및 자동 라우팅
- 이벤트별 완전한 데이터 격리

### 📱 **모던 웹 기술 활용**
- Next.js 14 App Router로 최신 React 기능 활용
- PWA로 네이티브 앱 수준의 사용자 경험
- 오프라인 지원으로 현장에서도 안정적 동작

### 🎨 **확장 가능한 디자인 시스템**
- SCSS + CSS Modules로 유지보수 용이한 스타일링
- 다크모드 및 테마 시스템으로 다양한 환경 지원
- 완전한 반응형 디자인으로 모든 기기 지원

### ⚡ **고성능 아키텍처**
- 코드 스플리팅 및 지연 로딩으로 빠른 초기 로딩
- React Query로 효율적인 서버 상태 관리
- 최적화된 이미지 및 에셋 처리

이제 **성능 최적화 및 보안** 문서를 작성하여 고성능 시스템 구현 방법을 다루겠습니다! 💪